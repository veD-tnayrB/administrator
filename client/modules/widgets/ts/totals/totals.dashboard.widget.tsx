import React, { LegacyRef } from 'react';
import { TotalsWidgetManager } from './totals.widget.manager';
import { useBinder } from '@beyond-js/react-18-widgets/hooks';
import { TotalItem } from './components/total.item.widget';

const manager = new TotalsWidgetManager();

export /*bundle*/ const TotalsWidget = React.forwardRef((props, ref: LegacyRef<HTMLDivElement>) => {
	const [data, setData] = React.useState<Record<string, number>>(manager.data);
	useBinder([manager], () => setData(manager.data));

	React.useEffect(() => {
		manager.load();
	}, []);
	return (
		<div ref={ref}>
			<section className="totals-widget">
				<TotalItem
					title="Users"
					amount={data?.users || '0'}
					icon='<svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke-width="1.5" viewBox="0 0 24 24" color="#000000"><path stroke="#000000" stroke-width="1.5" stroke-linecap="round" d="M1 20v-1a7 7 0 0 1 7-7v0a7 7 0 0 1 7 7v1"></path><path stroke="#000000" stroke-width="1.5" stroke-linecap="round" d="M13 14v0a5 5 0 0 1 5-5v0a5 5 0 0 1 5 5v.5"></path><path stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8ZM18 9a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"></path></svg>'
				/>
				<TotalItem
					title="Notifications"
					amount={data?.notifications || '0'}
					icon='<svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke-width="1.5" viewBox="0 0 24 24" color="#000000"><path stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" d="M21 7.353v9.294a.6.6 0 0 1-.309.525l-8.4 4.666a.6.6 0 0 1-.582 0l-8.4-4.666A.6.6 0 0 1 3 16.647V7.353a.6.6 0 0 1 .309-.524l8.4-4.667a.6.6 0 0 1 .582 0l8.4 4.667a.6.6 0 0 1 .309.524Z"></path><path stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" d="m3.528 7.294 8.18 4.544a.6.6 0 0 0 .583 0l8.209-4.56M12 21v-9"></path></svg>'
				/>
				<TotalItem
					title="Profiles"
					amount={data?.profiles || '0'}
					icon='<svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke-width="1.5" viewBox="0 0 24 24" color="#000000"><path stroke="#000000" stroke-width="1.5" stroke-dasharray="3 3" stroke-linecap="round" stroke-linejoin="round" d="M22 16c0-5.523-4.477-10-10-10-4.1 0-7.625 2.468-9.168 6"></path><path fill="#000000" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" d="M2 17a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z"></path><path stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" d="M2 16h10"></path><path fill="#000000" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" d="M12 17a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z"></path></svg>'
				/>
			</section>
		</div>
	);
});
